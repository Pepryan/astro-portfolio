---
title: "Docker Best Practices for Production"
date: "2024-12-01"
tags: ["docker", "devops", "containers", "production"]
category: "DevOps"
summary: "Essential Docker best practices for building secure, efficient, and maintainable containers in production environments."
author: "Febryan Ramadhan"
difficulty: "Intermediate"
keywords: ["docker", "containers", "production", "best practices", "security"]
draft: false
---

# Docker Best Practices for Production

Docker has revolutionized how we build, ship, and run applications. However, moving from development to production requires following specific best practices to ensure security, performance, and maintainability.

## Image Optimization

### Use Multi-Stage Builds

```dockerfile
# Build stage
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

# Production stage
FROM node:18-alpine AS production
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

### Choose the Right Base Image

- **Alpine Linux** for minimal size
- **Distroless** for maximum security
- **Official images** for reliability

## Security Best Practices

### Run as Non-Root User

```dockerfile
FROM node:18-alpine
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001
USER nextjs
```

### Scan for Vulnerabilities

```bash
# Using Docker Scout
docker scout cves my-image:latest

# Using Trivy
trivy image my-image:latest
```

## Performance Optimization

### Layer Caching

```dockerfile
# Copy package files first
COPY package*.json ./
RUN npm ci --only=production

# Copy source code last
COPY . .
```

### Resource Limits

```yaml
# docker-compose.yml
services:
  app:
    image: my-app:latest
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 256M
```

## Production Deployment

### Health Checks

```dockerfile
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1
```

### Logging Configuration

```yaml
services:
  app:
    image: my-app:latest
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
```

## Monitoring and Observability

### Container Metrics

- **CPU and Memory usage**
- **Network I/O**
- **Disk usage**
- **Container restart count**

### Application Metrics

- **Response times**
- **Error rates**
- **Throughput**
- **Custom business metrics**

## Conclusion

Following these Docker best practices ensures your containers are secure, performant, and production-ready. Regular updates and monitoring are key to maintaining a healthy containerized environment.
